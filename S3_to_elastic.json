{"paragraphs":[{"text":"%pyspark\nimport boto3\nimport re\nimport requests\nfrom requests_aws4auth import AWS4Auth\nimport json\n\n\n\nregion = 'us-east-1' # e.g. us-west-1\nservice = 'es'\ncredentials = boto3.Session().get_credentials()\nawsauth = AWS4Auth(credentials.access_key, credentials.secret_key, region, service, session_token=credentials.token)\nheaders = { \"Content-Type\": \"application/json\" }\n\n\n\n\n\n\n\n","user":"anonymous","dateUpdated":"2018-11-26T11:14:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543229476154_1707248369","id":"20170928-181313_2051212155","dateCreated":"2018-11-26T10:51:16+0000","dateStarted":"2018-11-26T11:12:18+0000","dateFinished":"2018-11-26T11:12:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1732"},{"text":"%pyspark\nendpoint = \"https://search-paulo-rqcjgsi6yxfliupadg7wclu57m.us-east-1.es.amazonaws.com\" #endpoint\nindex = 'all'\nl_type = 'data2'\nurl = endpoint + '/' + index + '/' + l_type","user":"anonymous","dateUpdated":"2018-11-26T11:14:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543230867027_-946608584","id":"20181126-111427_1761481974","dateCreated":"2018-11-26T11:14:27+0000","dateStarted":"2018-11-26T11:14:41+0000","dateFinished":"2018-11-26T11:14:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1733"},{"text":"%pyspark\n\ndf = spark.read.csv(\"s3n://amazon-reviews-pds/tsv/amazon_reviews_us_Digital_Software_v1_00.tsv.gz\", sep='\\t', header=True)\ndf.show()","user":"anonymous","dateUpdated":"2018-11-26T11:23:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n|marketplace|customer_id|     review_id|product_id|product_parent|       product_title|product_category|star_rating|helpful_votes|total_votes|vine|verified_purchase|     review_headline|         review_body|review_date|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n|         US|   17747349|R2EI7QLPK4LF7U|B00U7LCE6A|     106182406|CCleaner Free [Do...|Digital_Software|          4|            0|          0|   N|                Y|          Four Stars|      So far so good| 2015-08-31|\n|         US|   10956619|R1W5OMFK1Q3I3O|B00HRJMOM4|     162269768|ResumeMaker Profe...|Digital_Software|          3|            0|          0|   N|                Y|         Three Stars|Needs a little mo...| 2015-08-31|\n|         US|   13132245| RPZWSYWRP92GI|B00P31G9PQ|     831433899|Amazon Drive Desk...|Digital_Software|          1|            1|          2|   N|                Y|            One Star|      Please cancel.| 2015-08-31|\n|         US|   35717248|R2WQWM04XHD9US|B00FGDEPDY|     991059534|Norton Internet S...|Digital_Software|          5|            0|          0|   N|                Y|  Works as Expected!|  Works as Expected!| 2015-08-31|\n|         US|   17710652|R1WSPK2RA2PDEF|B00FZ0FK0U|     574904556|SecureAnywhere In...|Digital_Software|          4|            1|          2|   N|                Y|Great antivirus. ...|I've had Webroot ...| 2015-08-31|\n|         US|   42392705|R11JVGRZRHTDAS|B004KPKSRQ|     306022575|Pc Matic Performa...|Digital_Software|          5|            4|          4|   N|                N|Great choice in s...|EXCELLENT softwar...| 2015-08-31|\n|         US|   52845868|R2B8468OKXXYE2|B00B1TFNTW|      54873662|Microsoft OneNote...|Digital_Software|          1|            1|          1|   N|                N|Munch, munch, mun...|The variations cr...| 2015-08-31|\n|         US|   15696503|R2HGGCCZSSNUCB|B00M9GTJLY|     103182180|Intuit Quicken Re...|Digital_Software|          1|            0|          0|   N|                Y|Horrible! Would n...|Horrible!  Would ...| 2015-08-31|\n|         US|    9723928| REEE4LHSVPRV9|B00H9A60O4|     608720080|Avast Free Antivi...|Digital_Software|          1|            0|          0|   N|                Y|            One Star|     Waste of time .| 2015-08-31|\n|         US|   23522877|R25OMUUILFFHI9|B008XAXAC4|      87969525|Apache OpenOffice...|Digital_Software|          5|            0|          0|   N|                Y|Very good suite o...|Work as easy as o...| 2015-08-31|\n|         US|   17022093|R2966PB8UBD5BM|B00MHZ6Z64|     249773946|     Norton Security|Digital_Software|          5|            0|          0|   N|                Y|          Five Stars|    Works perfectly!| 2015-08-31|\n|         US|   11635690|R1OU91L2G5H6H1|B00OPCQ70Q|     956532818|Corel Painter Ess...|Digital_Software|          1|            0|          2|   N|                Y|            One Star|Will not open on ...| 2015-08-31|\n|         US|   50349059|R3M6YQVMXWGTR6|B00MHZ71G2|       8655796|Norton Security w...|Digital_Software|          5|            0|          0|   N|                Y|Purchased this on...|Purchased this on...| 2015-08-31|\n|         US|     450121|R2M8VZGO4BFN9J|B00O8J0W6G|       7338419|Movavi Screen Cap...|Digital_Software|          1|            0|          1|   N|                Y|            One Star|God awful and did...| 2015-08-31|\n|         US|    2320642|R3UH0MJKIJ4VLP|B00NMPZCH6|     985055699|Photoshop Element...|Digital_Software|          3|            2|          3|   N|                Y|         Three Stars|I think its compl...| 2015-08-31|\n|         US|   16089737|R3E906WYGZVKWO|B012P5SJNC|     490456974|LearnSmart for Th...|Digital_Software|          1|            2|          2|   N|                Y|Will not work for...|You can purchase ...| 2015-08-31|\n|         US|   14082044|R1Z3N8UA5YQOV2|B00V9ZPIXY|      57097904|Fotor for Windows...|Digital_Software|          2|            0|          0|   N|                Y|           Two Stars|    it wont download| 2015-08-31|\n|         US|   18246272|R2VH10XSOR1QHF|B00LU2XHAC|     962800663|Kaspersky Anti-Vi...|Digital_Software|          5|            0|          0|   N|                Y|          Five Stars|I have been using...| 2015-08-31|\n|         US|   31837971|R1KCPJ8UASZESF|B0068TJOSQ|     154476766|H&R Block At Home...|Digital_Software|          5|            0|          0|   N|                Y|This was a Great ...|This was a Great ...| 2015-08-31|\n|         US|   12631500| RWTF87EKV4DYO|B00SGYWM80|     780881648| onlineTV [Download]|Digital_Software|          3|            0|          0|   N|                Y|         Three Stars|did not use,inter...| 2015-08-31|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-101.ec2.internal:4040/jobs/job?id=11","http://ip-172-31-64-101.ec2.internal:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543229476159_1752687343","id":"20181122-204140_100673123","dateCreated":"2018-11-26T10:51:16+0000","dateStarted":"2018-11-26T11:12:21+0000","dateFinished":"2018-11-26T11:12:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1734"},{"text":"%pyspark\n\ndef send_to_es(file):\n    data = json.loads(file)\n    r = requests.post(url,auth=awsauth, json=data, headers=headers)\n    return r","user":"anonymous","dateUpdated":"2018-11-26T11:12:32+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543229476160_-1872486215","id":"20181122-204827_1449689731","dateCreated":"2018-11-26T10:51:16+0000","dateStarted":"2018-11-26T11:12:32+0000","dateFinished":"2018-11-26T11:12:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1735"},{"text":"%pyspark\n#df.toJSON().sample(withReplacement=False, fraction=0.01, seed=42).foreach(send_to_es)\ndf.toJSON().foreach(send_to_es)","user":"anonymous","dateUpdated":"2018-11-26T11:14:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-101.ec2.internal:4040/jobs/job?id=14"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543229476160_-1719395841","id":"20181122-205132_439541743","dateCreated":"2018-11-26T10:51:16+0000","dateStarted":"2018-11-26T11:14:56+0000","dateFinished":"2018-11-26T11:12:43+0000","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1736"},{"text":"%pyspark\nprint(suc)","user":"anonymous","dateUpdated":"2018-11-26T11:08:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[None]\n"}]},"apps":[],"jobName":"paragraph_1543229476161_-436202803","id":"20181122-224316_185202511","dateCreated":"2018-11-26T10:51:16+0000","dateStarted":"2018-11-26T11:08:14+0000","dateFinished":"2018-11-26T11:08:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1737"}],"name":"Completo_megadados","id":"2DVY6NBX4","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}